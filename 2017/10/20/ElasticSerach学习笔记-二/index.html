<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Elsaticsearch,">










<meta name="description" content="上一章介绍了Elasticserach安装和简单使用，这一章将主要整理Elasticserach的数据格式  数据的输入与输出什么是文档?在大多数应用中，多数实体或对象可以被序列化为包含键值对的 JSON 对象。 一个 键 可以是一个字段或字段的名称，一个 值 可以是一个字符串，一个数字，一个布尔值， 另一个对象，一些数组值，或一些其它特殊类型诸如表示日期的字符串，或代表一个地理位置的对象： 1">
<meta name="keywords" content="Elsaticsearch">
<meta property="og:type" content="article">
<meta property="og:title" content="Elsaticsearch学习笔记(二)">
<meta property="og:url" content="http://yoursite.com/2017/10/20/ElasticSerach学习笔记-二/index.html">
<meta property="og:site_name" content="Memories Off - Mine">
<meta property="og:description" content="上一章介绍了Elasticserach安装和简单使用，这一章将主要整理Elasticserach的数据格式  数据的输入与输出什么是文档?在大多数应用中，多数实体或对象可以被序列化为包含键值对的 JSON 对象。 一个 键 可以是一个字段或字段的名称，一个 值 可以是一个字符串，一个数字，一个布尔值， 另一个对象，一些数组值，或一些其它特殊类型诸如表示日期的字符串，或代表一个地理位置的对象： 1">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-10-20T16:45:21.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Elsaticsearch学习笔记(二)">
<meta name="twitter:description" content="上一章介绍了Elasticserach安装和简单使用，这一章将主要整理Elasticserach的数据格式  数据的输入与输出什么是文档?在大多数应用中，多数实体或对象可以被序列化为包含键值对的 JSON 对象。 一个 键 可以是一个字段或字段的名称，一个 值 可以是一个字符串，一个数字，一个布尔值， 另一个对象，一些数组值，或一些其它特殊类型诸如表示日期的字符串，或代表一个地理位置的对象： 1">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/10/20/ElasticSerach学习笔记-二/">





  <title>Elsaticsearch学习笔记(二) | Memories Off - Mine</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Memories Off - Mine</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/20/ElasticSerach学习笔记-二/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mr.Xia">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Memories Off - Mine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Elsaticsearch学习笔记(二)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-20T21:25:19+08:00">
                2017-10-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>上一章介绍了Elasticserach安装和简单使用，这一章将主要整理Elasticserach的数据格式</p>
</blockquote>
<h2 id="数据的输入与输出"><a href="#数据的输入与输出" class="headerlink" title="数据的输入与输出"></a>数据的输入与输出</h2><h3 id="什么是文档"><a href="#什么是文档" class="headerlink" title="什么是文档?"></a>什么是文档?</h3><p>在大多数应用中，多数实体或对象可以被序列化为包含键值对的 JSON 对象。 一个 <em>键</em> 可以是一个字段或字段的名称，一个 <em>值</em> 可以是一个字符串，一个数字，一个布尔值， 另一个对象，一些数组值，或一些其它特殊类型诸如表示日期的字符串，或代表一个地理位置的对象：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>:         <span class="string">"John Smith"</span>,</span><br><span class="line">    <span class="attr">"age"</span>:          <span class="number">42</span>,</span><br><span class="line">    <span class="attr">"confirmed"</span>:    <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"join_date"</span>:    <span class="string">"2014-06-01"</span>,</span><br><span class="line">    <span class="attr">"home"</span>: &#123;</span><br><span class="line">        <span class="attr">"lat"</span>:      <span class="number">51.5</span>,</span><br><span class="line">        <span class="attr">"lon"</span>:      <span class="number">0.1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"accounts"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"facebook"</span>,</span><br><span class="line">            <span class="attr">"id"</span>:   <span class="string">"johnsmith"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"twitter"</span>,</span><br><span class="line">            <span class="attr">"id"</span>:   <span class="string">"johnsmith"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>之前已经介绍文档不仅包含数据，也包含<em>元数据</em>——有关文档的信息。三个必须的元数据元素如下：</p>
<ul>
<li><p><code>_index</code></p>
<p>文档在哪存放</p>
</li>
<li><p><code>_type</code></p>
<p>文档表示的对象类别</p>
</li>
<li><p><code>_id</code></p>
<p>文档唯一标识</p>
</li>
</ul>
<h4 id="index"><a href="#index" class="headerlink" title="_index"></a>_index</h4><p>一个 <em>索引</em> 应该是因共同的特性被分组到一起的文档集合。 例如，你可能存储所有的产品在索引 <code>products</code>中，而存储所有销售的交易到索引 <code>sales</code> 中。 虽然也允许存储不相关的数据到一个索引中，但这通常看作是一个反模式的做法。</p>
<blockquote>
<p>实际上，在 Elasticsearch 中，我们的数据是被存储和索引在 <em>分片</em> 中，而一个索引仅仅是逻辑上的命名空间， 这个命名空间由一个或者多个分片组合在一起。</p>
</blockquote>
<p><em>索引</em>可以自行创建和管理，但也可以通过Elasticsearch自动生成，只需要我们起一个索引名。索引名字必须小写，不能以下划线开头，不能包含逗号。</p>
<h4 id="type"><a href="#type" class="headerlink" title="_type"></a>_type</h4><p>数据可能在索引中只是松散地组合在一起，但是实际操作中我们更倾向将这些数据进行分类。比如所有的产品都在一个索引中，但产品有许多不同的类别，同类的产品共享一种相同（或非常相似）的模式：有一个名称、描述、价格。Elasticsearch 公开了一个称为 <em>types</em> （类型）的特性，它允许您在索引中对数据进行逻辑分区。不同 types 的文档可能有不同的字段，但最好能够非常相似。</p>
<p>一个 <code>_type</code> 命名可以是大写或者小写，但是不能以下划线或者句号开头，不应该包含逗号， 并且长度限制为256个字符。</p>
<h4 id="id"><a href="#id" class="headerlink" title="_id"></a>_id</h4><p><em>ID</em> 是一个字符串， 当它和 <code>_index</code> 以及 <code>_type</code> 组合就可以唯一确定 Elasticsearch 中的一个文档。 当你创建一个新的文档，要么提供自己的 <code>_id</code> ，要么让 Elasticsearch 自动生成。</p>
<h3 id="如何对文档进行操作？"><a href="#如何对文档进行操作？" class="headerlink" title="如何对文档进行操作？"></a>如何对文档进行操作？</h3><p>要使Elasticsearch能够搜索到某个文档，需要先对文档进行<em>索引</em>——存储和使文档可被搜索。在此之前我们需要先确定文档的位置。正如刚刚所说的，一个文档的 <code>_index</code> 、 <code>_type</code> 和 <code>_id</code> 唯一标识一个文档。</p>
<h4 id="索引文档"><a href="#索引文档" class="headerlink" title="索引文档"></a>索引文档</h4><p>用如下方式的index_API进行索引文档，并提供自定义的_id：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PUT /&#123;index&#125;/&#123;type&#125;/&#123;id&#125;</span><br><span class="line">&#123;</span><br><span class="line">  "field": "value",</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Elasticsearch 响应体如下所示：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   "_index":    &#123;index&#125;,</span><br><span class="line">   "_type":     &#123;type&#125;,</span><br><span class="line">   "_id":       &#123;id&#125;,</span><br><span class="line">   "_version":  1,</span><br><span class="line">   "created":   true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该响应表明文档已经成功创建，其中多不光有<code>_index</code> 、 <code>_type</code> 和 <code>_id</code> 元数据，还有一个新元素：<code>_version</code> 。</p>
<p>在 Elasticsearch 中每个文档都有一个版本号。当每次对文档进行修改时（包括删除）， <code>_version</code> 的值会递增。</p>
<p>如果创建索引时不传递<code>_id</code>，则使用<code>POST</code>谓词，即：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST /&#123;index&#125;/&#123;type&#125;/</span><br><span class="line">&#123;</span><br><span class="line">  "field": "value",</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>则文档<code>_id</code>会由Elasticsearch 自动生成的，自动生成的id是 URL-safe、 基于 Base64 编码且长度为20个字符的 GUID 字符串。</p>
<h4 id="获取文档"><a href="#获取文档" class="headerlink" title="获取文档"></a>获取文档</h4><p>为了从 Elasticsearch 中检索出文档 ，我们仍然使用相同的 <code>_index</code> , <code>_type</code> , 和 <code>_id</code> ，但是 HTTP 谓词更改为 <code>GET</code>：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /&#123;index&#125;/&#123;type&#125;/&#123;id&#125;</span><br></pre></td></tr></table></figure>
<p>相应体会返回目前熟悉的元数据，再加上<code>_source</code>字段——包含我们索引数据时发送的原始JSON文档：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_index"</span> :   <span class="string">"website"</span>,</span><br><span class="line">  <span class="attr">"_type"</span> :    <span class="string">"blog"</span>,</span><br><span class="line">  <span class="attr">"_id"</span> :      <span class="string">"123"</span>,</span><br><span class="line">  <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">  <span class="attr">"found"</span> :    <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"_source"</span> :  &#123;</span><br><span class="line">      <span class="attr">"title"</span>: <span class="string">"My first blog entry"</span>,</span><br><span class="line">      <span class="attr">"text"</span>:  <span class="string">"Just trying this out..."</span>,</span><br><span class="line">      <span class="attr">"date"</span>:  <span class="string">"2014/01/01"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>GET</code> 请求的响应体包括 <code>{&quot;found&quot;: true}</code> ，这说明了文档已经被找到。否则<code>found</code>将会是<code>false</code>，HTTP相应码也将变成 <code>404 Not Found</code>。</p>
<p><code>GET</code> 请求 会返回整个文档，若只需要文档的部分字段，可以能用 <code>_source</code> 参数请求得到，多个字段也能使用逗号分隔的列表来指定。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /website/blog/123?_source=title,text</span><br></pre></td></tr></table></figure>
<p>或者，在返回结果中只返回<code>_source</code>字段：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /website/blog/123/_source</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其它的元数据不具有这样的功能</p>
</blockquote>
<h4 id="检查文档"><a href="#检查文档" class="headerlink" title="检查文档"></a>检查文档</h4><p>如果只想检查一个文档是否存在 –根本不想关心内容–那么用 <code>HEAD</code> 方法来代替 <code>GET</code> 方法。 <code>HEAD</code> 请求没有返回体，只返回一个 HTTP 请求报头：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEAD /megacorp/employee/1/_source</span><br></pre></td></tr></table></figure>
<p>如果文档存在，则会返回一个<code>200 ok</code> 的状态码，否则会返回一个 <code>404 Not Found</code> 的状态码。</p>
<h4 id="更新文档"><a href="#更新文档" class="headerlink" title="更新文档"></a>更新文档</h4><p>在 Elasticsearch 中文档是 <em>不可改变</em> 的，不能修改它们。 相反，如果想要更新现有的文档，需要 <em>重建索引</em>或者进行替换。替换的方式与索引的接口相同：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PUT /website/blog/123</span><br><span class="line">&#123;</span><br><span class="line">  "title": "My first blog entry",</span><br><span class="line">  "text":  "I am starting to get the hang of this...",</span><br><span class="line">  "date":  "2014/01/02"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在返回的响应中，可以发现<code>_version</code>字段值已经增加了，并且<code>created</code>标志变为了<code>false</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "_index" :   "website",</span><br><span class="line">  "_type" :    "blog",</span><br><span class="line">  "_id" :      "123",</span><br><span class="line">  "_version" : 2,</span><br><span class="line">  "created":   false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="创建新文档"><a href="#创建新文档" class="headerlink" title="创建新文档"></a>创建新文档</h4><p>刚的更新文档中，可以发现覆盖更新与索引一个文档的接口是一样的，那如何确认我们正在创建一个全新的文档，而不是覆盖现有的呢?</p>
<p>最简单的方式是使用<code>POST</code>类型的索引请求让es自动生成唯一id：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/</span><br><span class="line">&#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们已有<code>_id</code>，且必须要Elasticsearch只有在相同的 <code>_index</code> 、 <code>_type</code> 和 <code>_id</code> 不存在时才接受我们的索引请求，那么有两种方式：</p>
<ul>
<li><p>使用op_type参数</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PUT /website/blog/123?op_type=create</span><br><span class="line">&#123; ... &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在URL末端使用<code>/_create</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PUT /website/blog/123/_create</span><br><span class="line">&#123; ... &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>这两种方式在相同的数据已经存在时，将会返回<code>409 Conflict</code> 响应码，以及如下的错误信息：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"error"</span>: &#123;</span><br><span class="line">      <span class="attr">"root_cause"</span>: [</span><br><span class="line">         &#123;</span><br><span class="line">            <span class="attr">"type"</span>: <span class="string">"document_already_exists_exception"</span>,</span><br><span class="line">            <span class="attr">"reason"</span>: <span class="string">"[blog][123]: document already exists"</span>,</span><br><span class="line">            <span class="attr">"shard"</span>: <span class="string">"0"</span>,</span><br><span class="line">            <span class="attr">"index"</span>: <span class="string">"website"</span></span><br><span class="line">         &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"document_already_exists_exception"</span>,</span><br><span class="line">      <span class="attr">"reason"</span>: <span class="string">"[blog][123]: document already exists"</span>,</span><br><span class="line">      <span class="attr">"shard"</span>: <span class="string">"0"</span>,</span><br><span class="line">      <span class="attr">"index"</span>: <span class="string">"website"</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">"status"</span>: <span class="number">409</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="删除文档"><a href="#删除文档" class="headerlink" title="删除文档"></a>删除文档</h4><p>删除文档的语法与查询的规则相同，只是使用<code>DELETE</code>方法：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE /website/blog/123</span><br></pre></td></tr></table></figure>
<h4 id="部分更新文档"><a href="#部分更新文档" class="headerlink" title="部分更新文档"></a>部分更新文档</h4><p>文档除了可以被全部更新重建，还可以使用<code>update</code>API进行部分更新。而这种更新实质上是一个<em>检索-修改-重建索引</em> 的处理过程。与自行检索并重建索引相比， 区别在于这个过程发生在分片内部，这样就避免了多次请求的网络开销。</p>
<p><code>update</code> 请求最简单的一种形式是接收文档的一部分作为 <code>doc</code> 的参数， 它只是与现有的文档进行合并。对象被合并到一起，覆盖现有的字段，增加新的字段。例如，我们增加 <code>tags</code> 和 <code>views</code> 到我们的博客文章，如下所示：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/1/_update</span><br><span class="line">&#123;</span><br><span class="line">   "doc" : &#123;</span><br><span class="line">      "tags" : [ "testing" ],</span><br><span class="line">      "views": 0</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>检索文档显示了更新后的 <code>_source</code> 字段：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"_index"</span>:    <span class="string">"website"</span>,</span><br><span class="line">   <span class="attr">"_type"</span>:     <span class="string">"blog"</span>,</span><br><span class="line">   <span class="attr">"_id"</span>:       <span class="string">"1"</span>,</span><br><span class="line">   <span class="attr">"_version"</span>:  <span class="number">3</span>,</span><br><span class="line">   <span class="attr">"found"</span>:     <span class="literal">true</span>,</span><br><span class="line">   <span class="attr">"_source"</span>: &#123;</span><br><span class="line">      <span class="attr">"title"</span>:  <span class="string">"My first blog entry"</span>,</span><br><span class="line">      <span class="attr">"text"</span>:   <span class="string">"Starting to get the hang of this..."</span>,</span><br><span class="line">      <span class="attr">"tags"</span>: [ <span class="string">"testing"</span> ],</span><br><span class="line">      <span class="attr">"views"</span>:  <span class="number">0</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在<code>update</code>API中，除了使用doc字段，还可以使用脚本（scrpit）字段进行部分更新</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/1/_update</span><br><span class="line">&#123;</span><br><span class="line">   "script" : "ctx._source.views+=1"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们也可以通过使用脚本给 <code>tags</code> 数组添加一个新的标签。在这个例子中，我们指定新的标签作为参数，而不是硬编码到脚本内部。 这使得 Elasticsearch 可以重用这个脚本，而不是每次我们想添加标签时都要对新脚本重新编译：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/1/_update</span><br><span class="line">&#123;</span><br><span class="line">   "script" : "ctx._source.tags+=new_tag",</span><br><span class="line">   "params" : &#123;</span><br><span class="line">      "new_tag" : "search"</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们甚至可以选择通过设置 <code>ctx.op</code> 为 <code>delete</code> 来删除基于其内容的文档</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/1/_update</span><br><span class="line">&#123;</span><br><span class="line">   "script" : "ctx.op = ctx._source.views == count ? 'delete' : 'none'",</span><br><span class="line">    "params" : &#123;</span><br><span class="line">        "count": 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="更新可能不存在的文档"><a href="#更新可能不存在的文档" class="headerlink" title="更新可能不存在的文档"></a>更新可能不存在的文档</h4><p>假如我们希望更新一个计数器，而在更新之前，我们不能确定计数器已经存在。如果我们尝试更新一个不存在的文档，那么更新操作将会失败。</p>
<p>在这种情况下，可以使用<code>upsert</code>参数，指定如果文档不存在就先创建它：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /website/pageviews/1/_update</span><br><span class="line">&#123;</span><br><span class="line">   "script" : "ctx._source.views+=1",</span><br><span class="line">   "upsert": &#123;</span><br><span class="line">       "views": 1</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们第一次运行这个请求时， <code>upsert</code> 值作为新文档被索引，初始化 <code>views</code> 字段为 <code>1</code> 。 在后续的运行中，由于文档已经存在， <code>script</code> 更新操作将替代 <code>upsert</code> 进行应用，对 <code>views</code> 计数器进行累加。</p>
<h4 id="批量取回文档"><a href="#批量取回文档" class="headerlink" title="批量取回文档"></a>批量取回文档</h4><p>如果想一次取出多个文档，可以使用<code>mget</code> API 来将这些检索请求放在一个请求中，将比逐个文档请求更快地检索到全部文档。</p>
<p>示例如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET /_mget</span><br><span class="line">&#123;</span><br><span class="line">   "docs" : [</span><br><span class="line">      &#123;</span><br><span class="line">         "_index" : "website",</span><br><span class="line">         "_type" :  "blog",</span><br><span class="line">         "_id" :    2</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         "_index" : "website",</span><br><span class="line">         "_type" :  "pageviews",</span><br><span class="line">         "_id" :    1,</span><br><span class="line">         "_source": "views"</span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>每个文档包含需要检索文档的元数据，包括<code>_index</code> 、 <code>_type</code> 和 <code>_id</code> 。如果你想检索一个或者多个特定的字段，那么你可以通过 <code>_source</code> 参数来指定这些字段的名字。</p>
<p>该请求的响应也会包含一个<code>docs</code>数组，与请求中指定的文档一一对应，其中的每一个响应都和使用单个 <code>get</code> 请求所得到的响应体相同。</p>
<p>事实上，如果所有文档的 <code>_index</code> 和 <code>_type</code> 都是相同的，你可以只传一个 <code>ids</code> 数组，而不是整个 <code>docs</code>数组：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET /website/blog/_mget</span><br><span class="line">&#123;</span><br><span class="line">   "ids" : [ "2", "1" ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="批量操作"><a href="#批量操作" class="headerlink" title="批量操作"></a>批量操作</h4><p>与 <code>mget</code> 可以使我们一次取回多个文档同样的方式， <code>bulk</code> API 允许在单个步骤中进行多次 <code>create</code> 、 <code>index</code> 、 <code>update</code> 或 <code>delete</code> 请求。 如果你需要索引一个数据流比如日志事件，它可以排队和索引数百或数千批次。</p>
<p><code>bulk</code> 与其他的请求体格式稍有不同，如下所示：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123; action: &#123; metadata &#125;&#125;\n</span><br><span class="line">&#123; request body        &#125;\n</span><br><span class="line">&#123; action: &#123; metadata &#125;&#125;\n</span><br><span class="line">&#123; request body        &#125;\n</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这种格式类似一个有效的单行 JSON 文档 <em>流</em> ，它通过换行符(<code>\n</code>)连接到一起。注意两个要点：</p>
<ul>
<li>每行一定要以换行符(<code>\n</code>)结尾， <em>包括最后一行</em> 。这些换行符被用作一个标记，可以有效分隔行。</li>
<li>这些行不能包含未转义的换行符，因为他们将会对解析造成干扰。这意味着这个 JSON <em>不</em> 能使用 pretty 参数打印。</li>
</ul>
<p><code>action/metadata</code> 行指定 <em>哪一个文档</em> 做 <em>什么操作</em> 。</p>
<p><code>action</code> 必须是以下选项之一:</p>
<ul>
<li><p><code>create</code></p>
<p>如果文档不存在，那么就创建它。</p>
</li>
<li><p><code>index</code></p>
<p>创建一个新文档或者替换一个现有的文档。</p>
</li>
<li><p><code>update</code></p>
<p>部分更新一个文档。</p>
</li>
<li><p><code>delete</code></p>
<p>删除一个文档。</p>
</li>
</ul>
<p><code>metadata</code> 应该 指定被索引、创建、更新或者删除的文档的 <code>_index</code> 、 <code>_type</code> 和 <code>_id</code> 。</p>
<p>例如，一个 <code>delete</code> 请求看起来是这样的：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">"delete"</span>: &#123; <span class="attr">"_index"</span>: <span class="string">"website"</span>, <span class="attr">"_type"</span>: <span class="string">"blog"</span>, <span class="attr">"_id"</span>: <span class="string">"123"</span> &#125;&#125;</span><br></pre></td></tr></table></figure>
<p><code>request body</code> 行由文档的 <code>_source</code> 本身组成–文档包含的字段和值。它是 <code>index</code> 和 <code>create</code> 操作所必需的，这是有道理的：你必须提供文档以索引。</p>
<p>它也是 <code>update</code> 操作所必需的，并且应该包含你传递给 <code>update</code> API 的相同请求体： <code>doc</code> 、 <code>upsert</code> 、 <code>script</code> 等等。 删除操作不需要 <code>request body</code> 行。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">"create"</span>:  &#123; <span class="attr">"_index"</span>: <span class="string">"website"</span>, <span class="attr">"_type"</span>: <span class="string">"blog"</span>, <span class="attr">"_id"</span>: <span class="string">"123"</span> &#125;&#125;</span><br><span class="line">&#123; <span class="attr">"title"</span>:    <span class="string">"My first blog post"</span> &#125;</span><br></pre></td></tr></table></figure>
<p>为了把所有的操作组合在一起，一个完整的 <code>bulk</code> 请求 有以下形式:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /_bulk</span><br><span class="line">&#123; "delete": &#123; "_index": "website", "_type": "blog", "_id": "123" &#125;&#125;</span><br><span class="line">&#123; "create": &#123; "_index": "website", "_type": "blog", "_id": "123" &#125;&#125;</span><br><span class="line">&#123; "title":    "My first blog post" &#125;</span><br><span class="line">&#123; "index":  &#123; "_index": "website", "_type": "blog" &#125;&#125;</span><br><span class="line">&#123; "title":    "My second blog post" &#125;</span><br><span class="line">&#123; "update": &#123; "_index": "website", "_type": "blog", "_id": "123", "_retry_on_conflict" : 3&#125; &#125;</span><br><span class="line">&#123; "doc" : &#123;"title" : "My updated blog post"&#125; &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong></p>
<ol>
<li><code>delete</code>动作不能有请求体，其后跟着是另外一个操作。</li>
<li>最后一行要有换行符</li>
</ol>
</blockquote>
<p>这个 Elasticsearch 响应包含 <code>items</code> 数组， 这个数组的内容是以请求的顺序列出来的每个请求的结果。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"took"</span>: <span class="number">4</span>,</span><br><span class="line">   <span class="attr">"errors"</span>: <span class="literal">false</span>,</span><br><span class="line">   <span class="attr">"items"</span>: [</span><br><span class="line">      &#123;  <span class="attr">"delete"</span>: &#123;</span><br><span class="line">            <span class="attr">"_index"</span>:   <span class="string">"website"</span>,</span><br><span class="line">            <span class="attr">"_type"</span>:    <span class="string">"blog"</span>,</span><br><span class="line">            <span class="attr">"_id"</span>:      <span class="string">"123"</span>,</span><br><span class="line">            <span class="attr">"_version"</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">"status"</span>:   <span class="number">200</span>,</span><br><span class="line">            <span class="attr">"found"</span>:    <span class="literal">true</span></span><br><span class="line">      &#125;&#125;,</span><br><span class="line">      &#123;  <span class="attr">"create"</span>: &#123;</span><br><span class="line">            <span class="attr">"_index"</span>:   <span class="string">"website"</span>,</span><br><span class="line">            <span class="attr">"_type"</span>:    <span class="string">"blog"</span>,</span><br><span class="line">            <span class="attr">"_id"</span>:      <span class="string">"123"</span>,</span><br><span class="line">            <span class="attr">"_version"</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="attr">"status"</span>:   <span class="number">201</span></span><br><span class="line">      &#125;&#125;,</span><br><span class="line">      &#123;  <span class="attr">"create"</span>: &#123;</span><br><span class="line">            <span class="attr">"_index"</span>:   <span class="string">"website"</span>,</span><br><span class="line">            <span class="attr">"_type"</span>:    <span class="string">"blog"</span>,</span><br><span class="line">            <span class="attr">"_id"</span>:      <span class="string">"EiwfApScQiiy7TIKFxRCTw"</span>,</span><br><span class="line">            <span class="attr">"_version"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">"status"</span>:   <span class="number">201</span></span><br><span class="line">      &#125;&#125;,</span><br><span class="line">      &#123;  <span class="attr">"update"</span>: &#123;</span><br><span class="line">            <span class="attr">"_index"</span>:   <span class="string">"website"</span>,</span><br><span class="line">            <span class="attr">"_type"</span>:    <span class="string">"blog"</span>,</span><br><span class="line">            <span class="attr">"_id"</span>:      <span class="string">"123"</span>,</span><br><span class="line">            <span class="attr">"_version"</span>: <span class="number">4</span>,</span><br><span class="line">            <span class="attr">"status"</span>:   <span class="number">200</span></span><br><span class="line">      &#125;&#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>errors为false时，说明所有子请求都成功完成</p>
</blockquote>
<p>每个子请求都是独立执行，因此某个子请求的失败不会对其他子请求的成功与否造成影响。 如果其中任何子请求失败，最顶层的 <code>error</code> 标志被设置为 <code>true</code> ，并且在相应的请求报告出错误明细。这也意味着 <code>bulk</code> 请求不是原子的： 不能用它来实现事务控制。</p>
<p>像 <code>mget</code> API 一样，在 <code>bulk</code> 请求的 URL 中接收默认的 <code>/_index</code> 或者 <code>/_index/_type</code>。你仍然可以覆盖元数据行中的 <code>_index</code> 和 <code>_type</code> , 但是它将使用 URL 中的这些元数据值作为默认值：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST /website/log/_bulk</span><br><span class="line">&#123; "index": &#123;&#125;&#125;</span><br><span class="line">&#123; "event": "User logged in" &#125;</span><br><span class="line">&#123; "index": &#123; "_type": "blog" &#125;&#125;</span><br><span class="line">&#123; "title": "Overriding the default type" &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/elsaticsearch/" rel="tag"># Elsaticsearch</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/10/19/ElasticSerach学习笔记-一/" rel="next" title="Elsaticsearch学习笔记(一)">
                <i class="fa fa-chevron-left"></i> Elsaticsearch学习笔记(一)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/07/greys使用指南/" rel="prev" title="greys使用指南">
                greys使用指南 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Mr.Xia</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据的输入与输出"><span class="nav-number">1.</span> <span class="nav-text">数据的输入与输出</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是文档"><span class="nav-number">1.1.</span> <span class="nav-text">什么是文档?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#index"><span class="nav-number">1.1.1.</span> <span class="nav-text">_index</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#type"><span class="nav-number">1.1.2.</span> <span class="nav-text">_type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#id"><span class="nav-number">1.1.3.</span> <span class="nav-text">_id</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何对文档进行操作？"><span class="nav-number">1.2.</span> <span class="nav-text">如何对文档进行操作？</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#索引文档"><span class="nav-number">1.2.1.</span> <span class="nav-text">索引文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取文档"><span class="nav-number">1.2.2.</span> <span class="nav-text">获取文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#检查文档"><span class="nav-number">1.2.3.</span> <span class="nav-text">检查文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#更新文档"><span class="nav-number">1.2.4.</span> <span class="nav-text">更新文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建新文档"><span class="nav-number">1.2.5.</span> <span class="nav-text">创建新文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除文档"><span class="nav-number">1.2.6.</span> <span class="nav-text">删除文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#部分更新文档"><span class="nav-number">1.2.7.</span> <span class="nav-text">部分更新文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#更新可能不存在的文档"><span class="nav-number">1.2.8.</span> <span class="nav-text">更新可能不存在的文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#批量取回文档"><span class="nav-number">1.2.9.</span> <span class="nav-text">批量取回文档</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#批量操作"><span class="nav-number">1.2.10.</span> <span class="nav-text">批量操作</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr.Xia</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
